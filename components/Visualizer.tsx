import React, { useEffect, useRef } from 'react'; const Visualizer = ({ analyser, isActive, color }) => { const canvasRef = useRef(null); useEffect(() => { if (!isActive || !analyser || !canvasRef.current) return; const ctx = canvasRef.current.getContext('2d'); const bufferLength = analyser.frequencyBinCount; const dataArray = new Uint8Array(bufferLength); let id; const draw = () => { id = requestAnimationFrame(draw); analyser.getByteFrequencyData(dataArray); ctx.clearRect(0, 0, 300, 60); ctx.fillStyle = color; for (let i = 0; i < bufferLength; i++) { const h = (dataArray[i]/255)*60; ctx.fillRect(i*2.5, 60-h, 2, h); } }; draw(); return () => cancelAnimationFrame(id); }, [isActive, analyser]); return <canvas ref={canvasRef} className="w-full h-16 opacity-60" width={300} height={60} />; }; export default Visualizer;